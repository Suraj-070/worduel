{"ast":null,"code":"import React,{useEffect,useRef,useState}from\"react\";import\"../styles/Timer.css\";import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";export default function Timer(_ref){let{seconds,onTimeUp,paused}=_ref;const[timeLeft,setTimeLeft]=useState(seconds);const intervalRef=useRef(null);const onTimeUpRef=useRef(onTimeUp);const pausedRef=useRef(paused);const playedTimeup=useRef(false);// Sound refs\nconst countdownSound=useRef(null);const timeupSound=useRef(null);// Initialize sounds once\nuseEffect(()=>{countdownSound.current=new Audio(\"/sounds/countdown.mp3\");timeupSound.current=new Audio(\"/sounds/timeup.mp3\");countdownSound.current.volume=0.7;timeupSound.current.volume=0.8;},[]);// Keep refs updated without triggering re-renders\nuseEffect(()=>{onTimeUpRef.current=onTimeUp;},[onTimeUp]);useEffect(()=>{pausedRef.current=paused;},[paused]);// Reset when new round starts\nuseEffect(()=>{setTimeLeft(seconds);playedTimeup.current=false;},[seconds]);// Single clean interval\nuseEffect(()=>{if(intervalRef.current){clearInterval(intervalRef.current);intervalRef.current=null;}if(paused||seconds<=0)return;let current=seconds;intervalRef.current=setInterval(()=>{if(pausedRef.current)return;current-=1;setTimeLeft(current);// Play countdown beep in last 9 seconds\nif(current<=9&&current>0){if(countdownSound.current){countdownSound.current.currentTime=0;countdownSound.current.play().catch(()=>{});}}// Time up\nif(current<=0){var _onTimeUpRef$current;clearInterval(intervalRef.current);intervalRef.current=null;if(!playedTimeup.current){playedTimeup.current=true;if(timeupSound.current){timeupSound.current.play().catch(()=>{});}}(_onTimeUpRef$current=onTimeUpRef.current)===null||_onTimeUpRef$current===void 0?void 0:_onTimeUpRef$current.call(onTimeUpRef);}},1000);return()=>{if(intervalRef.current){clearInterval(intervalRef.current);intervalRef.current=null;}};},[seconds]);const mins=Math.floor(timeLeft/60);const secs=timeLeft%60;const pct=Math.max(0,timeLeft/seconds*100);const urgency=timeLeft<=9?\"urgent\":timeLeft<=60?\"warning\":\"normal\";return/*#__PURE__*/_jsxs(\"div\",{className:\"timer timer--\".concat(urgency),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"timer__display\",children:[String(mins).padStart(2,\"0\"),\":\",String(secs).padStart(2,\"0\")]}),/*#__PURE__*/_jsx(\"div\",{className:\"timer__bar\",children:/*#__PURE__*/_jsx(\"div\",{className:\"timer__fill\",style:{width:\"\".concat(pct,\"%\")}})})]});}","map":{"version":3,"names":["React","useEffect","useRef","useState","jsxs","_jsxs","jsx","_jsx","Timer","_ref","seconds","onTimeUp","paused","timeLeft","setTimeLeft","intervalRef","onTimeUpRef","pausedRef","playedTimeup","countdownSound","timeupSound","current","Audio","volume","clearInterval","setInterval","currentTime","play","catch","_onTimeUpRef$current","call","mins","Math","floor","secs","pct","max","urgency","className","concat","children","String","padStart","style","width"],"sources":["C:/Users/NITRO5/OneDrive/Desktop/worduel/client/src/components/Timer.jsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\r\nimport \"../styles/Timer.css\";\r\n\r\nexport default function Timer({ seconds, onTimeUp, paused }) {\r\n  const [timeLeft, setTimeLeft] = useState(seconds);\r\n  const intervalRef = useRef(null);\r\n  const onTimeUpRef = useRef(onTimeUp);\r\n  const pausedRef = useRef(paused);\r\n  const playedTimeup = useRef(false);\r\n\r\n  // Sound refs\r\n  const countdownSound = useRef(null);\r\n  const timeupSound = useRef(null);\r\n\r\n  // Initialize sounds once\r\n  useEffect(() => {\r\n    countdownSound.current = new Audio(\"/sounds/countdown.mp3\");\r\n    timeupSound.current = new Audio(\"/sounds/timeup.mp3\");\r\n    countdownSound.current.volume = 0.7;\r\n    timeupSound.current.volume = 0.8;\r\n  }, []);\r\n\r\n  // Keep refs updated without triggering re-renders\r\n  useEffect(() => {\r\n    onTimeUpRef.current = onTimeUp;\r\n  }, [onTimeUp]);\r\n  useEffect(() => {\r\n    pausedRef.current = paused;\r\n  }, [paused]);\r\n\r\n  // Reset when new round starts\r\n  useEffect(() => {\r\n    setTimeLeft(seconds);\r\n    playedTimeup.current = false;\r\n  }, [seconds]);\r\n\r\n  // Single clean interval\r\n  useEffect(() => {\r\n    if (intervalRef.current) {\r\n      clearInterval(intervalRef.current);\r\n      intervalRef.current = null;\r\n    }\r\n\r\n    if (paused || seconds <= 0) return;\r\n\r\n    let current = seconds;\r\n\r\n    intervalRef.current = setInterval(() => {\r\n      if (pausedRef.current) return;\r\n\r\n      current -= 1;\r\n      setTimeLeft(current);\r\n\r\n      // Play countdown beep in last 9 seconds\r\n      if (current <= 9 && current > 0) {\r\n        if (countdownSound.current) {\r\n          countdownSound.current.currentTime = 0;\r\n          countdownSound.current.play().catch(() => {});\r\n        }\r\n      }\r\n\r\n      // Time up\r\n      if (current <= 0) {\r\n        clearInterval(intervalRef.current);\r\n        intervalRef.current = null;\r\n\r\n        if (!playedTimeup.current) {\r\n          playedTimeup.current = true;\r\n          if (timeupSound.current) {\r\n            timeupSound.current.play().catch(() => {});\r\n          }\r\n        }\r\n\r\n        onTimeUpRef.current?.();\r\n      }\r\n    }, 1000);\r\n\r\n    return () => {\r\n      if (intervalRef.current) {\r\n        clearInterval(intervalRef.current);\r\n        intervalRef.current = null;\r\n      }\r\n    };\r\n  }, [seconds]);\r\n\r\n  const mins = Math.floor(timeLeft / 60);\r\n  const secs = timeLeft % 60;\r\n  const pct = Math.max(0, (timeLeft / seconds) * 100);\r\n  const urgency =\r\n    timeLeft <= 9 ? \"urgent\" : timeLeft <= 60 ? \"warning\" : \"normal\";\r\n\r\n  return (\r\n    <div className={`timer timer--${urgency}`}>\r\n      <div className=\"timer__display\">\r\n        {String(mins).padStart(2, \"0\")}:{String(secs).padStart(2, \"0\")}\r\n      </div>\r\n      <div className=\"timer__bar\">\r\n        <div className=\"timer__fill\" style={{ width: `${pct}%` }} />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}