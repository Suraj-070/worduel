{"ast":null,"code":"import React,{useState,useEffect,useCallback}from\"react\";import{useSocket}from\"../context/SocketContext\";import{useGame}from\"../context/GameContext\";import GuessGrid from\"../components/GuessGrid\";import LetterPool from\"../components/LetterPool\";import Timer from\"../components/Timer\";import ScoreBar from\"../components/ScoreBar\";import\"../styles/Game.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MAX_GUESSES=4;export default function Game(){const socket=useSocket();const{state,dispatch}=useGame();const[currentInput,setCurrentInput]=useState([]);const[shake,setShake]=useState(false);const[roundDone,setRoundDone]=useState(false);const{invalidWord}=state;const[timeUp,setTimeUp]=useState(false);const{shuffledLetters,wordLength,guesses,roomId,timeLimit,currentRound,totalRounds}=state;const submitGuess=useCallback(()=>{if(currentInput.length!==wordLength){setShake(true);setTimeout(()=>setShake(false),500);return;}const guess=currentInput.join(\"\");socket.emit(\"submit_guess\",{roomId,guess});setCurrentInput([]);},[currentInput,wordLength,socket,roomId]);const addLetter=useCallback(letter=>{if(currentInput.length<wordLength&&!roundDone){setCurrentInput(prev=>[...prev,letter]);}},[currentInput.length,wordLength,roundDone]);const removeLetter=useCallback(()=>{setCurrentInput(prev=>prev.slice(0,-1));},[]);useEffect(()=>{if(invalidWord){setShake(true);setTimeout(()=>{setShake(false);dispatch({type:\"CLEAR_INVALID\"});},2000);}},[invalidWord]);useEffect(()=>{const handleKey=e=>{if(roundDone)return;if(e.key===\"Backspace\")return removeLetter();if(e.key===\"Enter\")return submitGuess();if(/^[a-zA-Z]$/.test(e.key)){const letter=e.key.toLowerCase();if(shuffledLetters.includes(letter)&&currentInput.length<wordLength){addLetter(letter);}}};window.addEventListener(\"keydown\",handleKey);return()=>window.removeEventListener(\"keydown\",handleKey);},[removeLetter,submitGuess,addLetter,shuffledLetters,currentInput,wordLength,roundDone]);useEffect(()=>{const lastGuess=guesses[guesses.length-1];if(!lastGuess)return;const isCorrect=lastGuess.result.every(r=>r.status===\"correct\");if(isCorrect||guesses.length>=MAX_GUESSES){setRoundDone(true);}},[guesses]);useEffect(()=>{setRoundDone(false);setCurrentInput([]);setTimeUp(false);},[currentRound]);const handleTimeUp=()=>{if(!roundDone){setTimeUp(true);setRoundDone(true);socket.emit(\"time_up\",{roomId});}};const opponent=state.players.find(p=>p.id!==state.myId);const me=state.players.find(p=>p.id===state.myId);return/*#__PURE__*/_jsxs(\"div\",{className:\"game\",children:[/*#__PURE__*/_jsx(ScoreBar,{me:me,opponent:opponent,scores:state.scores,currentRound:currentRound,totalRounds:totalRounds,opponentGuessCount:state.opponentGuessCount}),/*#__PURE__*/_jsxs(\"div\",{className:\"game__header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"game__round-badge\",children:[\"ROUND \",currentRound,\"/\",totalRounds]}),/*#__PURE__*/_jsx(Timer,{seconds:timeLimit,onTimeUp:handleTimeUp,paused:roundDone})]}),/*#__PURE__*/_jsx(\"div\",{className:\"game__board\",children:/*#__PURE__*/_jsx(GuessGrid,{guesses:guesses,currentInput:currentInput,wordLength:wordLength,maxGuesses:MAX_GUESSES,shake:shake})}),roundDone&&/*#__PURE__*/_jsx(\"div\",{className:\"game__waiting-msg\",children:timeUp?\"⌛ TIME'S UP!\":\"⏳ Waiting for opponent to finish...\"}),state.invalidWord&&/*#__PURE__*/_jsx(\"div\",{className:\"game__invalid-msg\",children:\"\\u274C Not a valid word!\"}),!roundDone&&/*#__PURE__*/_jsxs(\"div\",{className:\"game__controls\",children:[/*#__PURE__*/_jsx(LetterPool,{letters:shuffledLetters,onLetterClick:addLetter,usedLetters:currentInput}),/*#__PURE__*/_jsxs(\"div\",{className:\"game__actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"game__btn game__btn--delete\",onClick:removeLetter,children:\"\\u232B DELETE\"}),/*#__PURE__*/_jsx(\"button\",{className:\"game__btn game__btn--enter\",onClick:submitGuess,disabled:currentInput.length!==wordLength,children:\"ENTER \\u21B5\"})]})]})]});}","map":{"version":3,"names":["React","useState","useEffect","useCallback","useSocket","useGame","GuessGrid","LetterPool","Timer","ScoreBar","jsx","_jsx","jsxs","_jsxs","MAX_GUESSES","Game","socket","state","dispatch","currentInput","setCurrentInput","shake","setShake","roundDone","setRoundDone","invalidWord","timeUp","setTimeUp","shuffledLetters","wordLength","guesses","roomId","timeLimit","currentRound","totalRounds","submitGuess","length","setTimeout","guess","join","emit","addLetter","letter","prev","removeLetter","slice","type","handleKey","e","key","test","toLowerCase","includes","window","addEventListener","removeEventListener","lastGuess","isCorrect","result","every","r","status","handleTimeUp","opponent","players","find","p","id","myId","me","className","children","scores","opponentGuessCount","seconds","onTimeUp","paused","maxGuesses","letters","onLetterClick","usedLetters","onClick","disabled"],"sources":["C:/Users/NITRO5/OneDrive/Desktop/worduel/client/src/pages/Game.jsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\r\nimport { useSocket } from \"../context/SocketContext\";\r\nimport { useGame } from \"../context/GameContext\";\r\nimport GuessGrid from \"../components/GuessGrid\";\r\nimport LetterPool from \"../components/LetterPool\";\r\nimport Timer from \"../components/Timer\";\r\nimport ScoreBar from \"../components/ScoreBar\";\r\nimport \"../styles/Game.css\";\r\n\r\nconst MAX_GUESSES = 4;\r\n\r\nexport default function Game() {\r\n  const socket = useSocket();\r\n  const { state, dispatch } = useGame();\r\n  const [currentInput, setCurrentInput] = useState([]);\r\n  const [shake, setShake] = useState(false);\r\n  const [roundDone, setRoundDone] = useState(false);\r\n  const { invalidWord } = state;\r\n  const [timeUp, setTimeUp] = useState(false);\r\n\r\n  const { shuffledLetters, wordLength, guesses, roomId, timeLimit, currentRound, totalRounds } = state;\r\n\r\n  const submitGuess = useCallback(() => {\r\n    if (currentInput.length !== wordLength) {\r\n      setShake(true);\r\n      setTimeout(() => setShake(false), 500);\r\n      return;\r\n    }\r\n    const guess = currentInput.join(\"\");\r\n    socket.emit(\"submit_guess\", { roomId, guess });\r\n    setCurrentInput([]);\r\n  }, [currentInput, wordLength, socket, roomId]);\r\n\r\n  \r\n\r\n  const addLetter = useCallback((letter) => {\r\n    if (currentInput.length < wordLength && !roundDone) {\r\n      setCurrentInput((prev) => [...prev, letter]);\r\n    }\r\n  }, [currentInput.length, wordLength, roundDone]);\r\n\r\n  const removeLetter = useCallback(() => {\r\n    setCurrentInput((prev) => prev.slice(0, -1));\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n  if (invalidWord) {\r\n    setShake(true);\r\n    setTimeout(() => {\r\n      setShake(false);\r\n      dispatch({ type: \"CLEAR_INVALID\" });\r\n    }, 2000);\r\n  }\r\n}, [invalidWord]);\r\n\r\n  useEffect(() => {\r\n    const handleKey = (e) => {\r\n      if (roundDone) return;\r\n      if (e.key === \"Backspace\") return removeLetter();\r\n      if (e.key === \"Enter\") return submitGuess();\r\n      if (/^[a-zA-Z]$/.test(e.key)) {\r\n        const letter = e.key.toLowerCase();\r\n        if (shuffledLetters.includes(letter) && currentInput.length < wordLength) {\r\n          addLetter(letter);\r\n        }\r\n      }\r\n    };\r\n    window.addEventListener(\"keydown\", handleKey);\r\n    return () => window.removeEventListener(\"keydown\", handleKey);\r\n  }, [removeLetter, submitGuess, addLetter, shuffledLetters, currentInput, wordLength, roundDone]);\r\n\r\n  useEffect(() => {\r\n    const lastGuess = guesses[guesses.length - 1];\r\n    if (!lastGuess) return;\r\n    const isCorrect = lastGuess.result.every((r) => r.status === \"correct\");\r\n    if (isCorrect || guesses.length >= MAX_GUESSES) {\r\n      setRoundDone(true);\r\n    }\r\n  }, [guesses]);\r\n\r\n  useEffect(() => {\r\n    setRoundDone(false);\r\n    setCurrentInput([]);\r\n    setTimeUp(false);\r\n  }, [currentRound]);\r\n\r\n  const handleTimeUp = () => {\r\n  if (!roundDone) {\r\n    setTimeUp(true);\r\n    setRoundDone(true);\r\n    socket.emit(\"time_up\", { roomId });\r\n  }\r\n};\r\n\r\n  const opponent = state.players.find((p) => p.id !== state.myId);\r\n  const me = state.players.find((p) => p.id === state.myId);\r\n\r\n  return (\r\n    <div className=\"game\">\r\n      <ScoreBar\r\n        me={me}\r\n        opponent={opponent}\r\n        scores={state.scores}\r\n        currentRound={currentRound}\r\n        totalRounds={totalRounds}\r\n        opponentGuessCount={state.opponentGuessCount}\r\n      />\r\n      <div className=\"game__header\">\r\n        <div className=\"game__round-badge\">ROUND {currentRound}/{totalRounds}</div>\r\n        <Timer seconds={timeLimit} onTimeUp={handleTimeUp} paused={roundDone} />\r\n      </div>\r\n      <div className=\"game__board\">\r\n        <GuessGrid\r\n          guesses={guesses}\r\n          currentInput={currentInput}\r\n          wordLength={wordLength}\r\n          maxGuesses={MAX_GUESSES}\r\n          shake={shake}\r\n        />\r\n      </div>\r\n      {roundDone && (\r\n  <div className=\"game__waiting-msg\">\r\n    {timeUp ? \"⌛ TIME'S UP!\" : \"⏳ Waiting for opponent to finish...\"}\r\n  </div>\r\n)}\r\n      {state.invalidWord && (\r\n  <div className=\"game__invalid-msg\">❌ Not a valid word!</div>\r\n)}\r\n      {!roundDone && (\r\n        <div className=\"game__controls\">\r\n          <LetterPool\r\n            letters={shuffledLetters}\r\n            onLetterClick={addLetter}\r\n            usedLetters={currentInput}\r\n          />\r\n          <div className=\"game__actions\">\r\n            <button className=\"game__btn game__btn--delete\" onClick={removeLetter}>\r\n              ⌫ DELETE\r\n            </button>\r\n            <button\r\n              className=\"game__btn game__btn--enter\"\r\n              onClick={submitGuess}\r\n              disabled={currentInput.length !== wordLength}\r\n            >\r\n              ENTER ↵\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}